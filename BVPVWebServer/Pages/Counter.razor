@page "/counter"

@using Microsoft.AspNetCore.Components.Server.ProtectedBrowserStorage
@inject ProtectedSessionStorage _sessionStore

@inject StateService _stateService
@inject NavigationManager _navMgr
@{
    if (!_stateService.IsLoggedIn)
    {
        _navMgr.NavigateTo("/");
    }
    else
    {<PageTitle>Counter</PageTitle>

        <h1>Counter</h1>

        <p role="status">Current count: @_currentCount</p>

        <button class="btn btn-primary" @onclick="IncrementCount">Click me</button>

    }
}


@code {
    protected override async Task OnInitializedAsync()
    {
        var result = await _sessionStore.GetAsync<string>("User");
        if (result.Value is not {Length: > 1 }) _navMgr.NavigateTo("/");
    }
    
    private int _currentCount = 0;

    private void IncrementCount()
    {
        _currentCount++;
    }

}